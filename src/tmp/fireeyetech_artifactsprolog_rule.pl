%% 'Filename', 'MD5 Hash', 'Size (bytes)', 'Compile Time', 'Description', 'Filetype', malware 
fileCharaMalware(wannacry_filechara1, wannacry).
fileChara('mssecsvc.exe', 'db349b97c37d22f5ea1d1841e3c89eb4', '3723264', '2010-11-20T09:03:08Z', 'Loader + Worm Component', 'EXE', wannacry_filechara1).
fileCharaMalware(wannacry_filechara2, wannacry).
fileChara('tasksche.exe', '84c82835a5d21bbcf75a61706d8ab549', '3514368', '2010-11-20T09:05:05Z', 'Loader', 'EXE', wannacry_filechara2).
fileCharaMalware(wannacry_filechara3, wannacry).
fileChara('Unavailable', 'f351e1fcca0c4ea05fc44d15a17f8b36', '65536', '2009-07-14 01:12:55Z', 'Encryptor', 'DLL', wannacry_filechara3).
fileCharaMalware(wannacry_filechara4, wannacry).
fileChara('@WanaDecryptor@.exe', '7bf2b57f2a205768755c07f238fb32cc', '245760', '2009-07-13 23:19:35Z', 'Decryptor', 'EXE', wannacry_filechara4).


% filename, path, MD5, malware 
loaderFileArtifactMalware(wannacry_loaderfileArt0, wannacry).
loaderFileArtifact('tasksche.exe', 'C:\WINDOWS\', '84c82835a5d21bbcf75a61706d8ab549', wannacry_loaderfileArt0).
loaderFileArtifactMalware(wannacry_loaderfileArt1, wannacry).
loaderFileArtifact('m_bulgarian.wnry', '%CD%\msg\', '95673b0f968c0f55b32204361940d184', wannacry_loaderfileArt1).
loaderFileArtifactMalware(wannacry_loaderfileArt2, wannacry).
loaderFileArtifact('m_chinese (simplified).wnry', '%CD%\msg\', '0252d45ca21c8e43c9742285c48e91ad', wannacry_loaderfileArt2).
loaderFileArtifactMalware(wannacry_loaderfileArt3, wannacry).
loaderFileArtifact('m_chinese (traditional).wnry', '%CD%\msg\', '2efc3690d67cd073a9406a25005f7cea', wannacry_loaderfileArt3).
loaderFileArtifactMalware(wannacry_loaderfileArt4, wannacry).
loaderFileArtifact('m_croatian.wnry', '%CD%\msg\', '17194003fa70ce477326ce2f6deeb270', wannacry_loaderfileArt4).
loaderFileArtifactMalware(wannacry_loaderfileArt5, wannacry).
loaderFileArtifact('m_czech.wnry', '%CD%\msg\', '537efeecdfa94cc421e58fd82a58ba9e', wannacry_loaderfileArt5).
loaderFileArtifactMalware(wannacry_loaderfileArt6, wannacry).
loaderFileArtifact('m_danish.wnry', '%CD%\msg\', '2c5a3b81d5c4715b7bea01033367fcb5', wannacry_loaderfileArt6).
loaderFileArtifactMalware(wannacry_loaderfileArt7, wannacry).
loaderFileArtifact('m_dutch.wnry', '%CD%\msg\', '7a8d499407c6a647c03c4471a67eaad7', wannacry_loaderfileArt7).
loaderFileArtifactMalware(wannacry_loaderfileArt8, wannacry).
loaderFileArtifact('m_english.wnry', '%CD%\msg\', 'fe68c2dc0d2419b38f44d83f2fcf232e', wannacry_loaderfileArt8).
loaderFileArtifactMalware(wannacry_loaderfileArt9, wannacry).
loaderFileArtifact('m_filipino.wnry', '%CD%\msg\', '08b9e69b57e4c9b966664f8e1c27ab09', wannacry_loaderfileArt9).
loaderFileArtifactMalware(wannacry_loaderfileArt10, wannacry).
loaderFileArtifact('m_finnish.wnry', '%CD%\msg\', '35c2f97eea8819b1caebd23fee732d8f', wannacry_loaderfileArt10).
loaderFileArtifactMalware(wannacry_loaderfileArt11, wannacry).
loaderFileArtifact('m_french.wnry', '%CD%\msg\', '4e57113a6bf6b88fdd32782a4a381274', wannacry_loaderfileArt11).
loaderFileArtifactMalware(wannacry_loaderfileArt12, wannacry).
loaderFileArtifact('m_german.wnry', '%CD%\msg\', '3d59bbb5553fe03a89f817819540f469', wannacry_loaderfileArt12).
loaderFileArtifactMalware(wannacry_loaderfileArt13, wannacry).
loaderFileArtifact('m_greek.wnry', '%CD%\msg\', 'fb4e8718fea95bb7479727fde80cb424', wannacry_loaderfileArt13).
loaderFileArtifactMalware(wannacry_loaderfileArt14, wannacry).
loaderFileArtifact('m_indonesian.wnry', '%CD%\msg\', '3788f91c694dfc48e12417ce93356b0f', wannacry_loaderfileArt14).
loaderFileArtifactMalware(wannacry_loaderfileArt15, wannacry).
loaderFileArtifact('m_italian.wnry', '%CD%\msg\', '30a200f78498990095b36f574b6e8690', wannacry_loaderfileArt15).
loaderFileArtifactMalware(wannacry_loaderfileArt16, wannacry).
loaderFileArtifact('m_japanese.wnry', '%CD%\msg\', 'b77e1221f7ecd0b5d696cb66cda1609e', wannacry_loaderfileArt16).
loaderFileArtifactMalware(wannacry_loaderfileArt17, wannacry).
loaderFileArtifact('m_korean.wnry', '%CD%\msg\', '6735cb43fe44832b061eeb3f5956b099', wannacry_loaderfileArt17).
loaderFileArtifactMalware(wannacry_loaderfileArt18, wannacry).
loaderFileArtifact('m_latvian.wnry', '%CD%\msg\', 'c33afb4ecc04ee1bcc6975bea49abe40', wannacry_loaderfileArt18).
loaderFileArtifactMalware(wannacry_loaderfileArt19, wannacry).
loaderFileArtifact('m_norwegian.wnry', '%CD%\msg\', 'ff70cc7c00951084175d12128ce02399', wannacry_loaderfileArt19).
loaderFileArtifactMalware(wannacry_loaderfileArt20, wannacry).
loaderFileArtifact('m_polish.wnry', '%CD%\msg\', 'e79d7f2833a9c2e2553c7fe04a1b63f4', wannacry_loaderfileArt20).
loaderFileArtifactMalware(wannacry_loaderfileArt21, wannacry).
loaderFileArtifact('m_portuguese.wnry', '%CD%\msg\', 'fa948f7d8dfb21ceddd6794f2d56b44f', wannacry_loaderfileArt21).
loaderFileArtifactMalware(wannacry_loaderfileArt22, wannacry).
loaderFileArtifact('m_romanian.wnry', '%CD%\msg\', '313e0ececd24f4fa1504118a11bc7986', wannacry_loaderfileArt22).
loaderFileArtifactMalware(wannacry_loaderfileArt23, wannacry).
loaderFileArtifact('m_russian.wnry', '%CD%\msg\', '452615db2336d60af7e2057481e4cab5', wannacry_loaderfileArt23).
loaderFileArtifactMalware(wannacry_loaderfileArt24, wannacry).
loaderFileArtifact('m_slovak.wnry', '%CD%\msg\', 'c911aba4ab1da6c28cf86338ab2ab6cc', wannacry_loaderfileArt24).
loaderFileArtifactMalware(wannacry_loaderfileArt25, wannacry).
loaderFileArtifact('m_spanish.wnry', '%CD%\msg\', '8d61648d34cba8ae9d1e2a219019add1', wannacry_loaderfileArt25).
loaderFileArtifactMalware(wannacry_loaderfileArt26, wannacry).
loaderFileArtifact('m_swedish.wnry', '%CD%\msg\', 'c7a19984eb9f37198652eaf2fd1ee25c', wannacry_loaderfileArt26).
loaderFileArtifactMalware(wannacry_loaderfileArt27, wannacry).
loaderFileArtifact('m_turkish.wnry', '%CD%\msg\', '531ba6b1a5460fc9446946f91cc8c94b', wannacry_loaderfileArt27).
loaderFileArtifactMalware(wannacry_loaderfileArt28, wannacry).
loaderFileArtifact('m_vietnamese.wnr', '%CD%\msg\', '8419be28a0dcec3f55823620922b00fa', wannacry_loaderfileArt28).
loaderFileArtifactMalware(wannacry_loaderfileArt29, wannacry).
loaderFileArtifact('t.wnry', '%CD%', '5dcaac857e695a65f5c3ef1441a73a8f', wannacry_loaderfileArt29).
loaderFileArtifactMalware(wannacry_loaderfileArt30, wannacry).
loaderFileArtifact('taskdl.exe', '%CD%', '4fef5e34143e646dbf9907c4374276f5', wannacry_loaderfileArt30).
loaderFileArtifactMalware(wannacry_loaderfileArt31, wannacry).
loaderFileArtifact('taskse.exe', '%CD%', '8495400f199ac77853c53b5a3f278f3e', wannacry_loaderfileArt31).
loaderFileArtifactMalware(wannacry_loaderfileArt32, wannacry).
loaderFileArtifact('u.wnry', '%CD%', '7bf2b57f2a205768755c07f238fb32cc', wannacry_loaderfileArt32).
loaderFileArtifactMalware(wannacry_loaderfileArt33, wannacry).
loaderFileArtifact('b.wnry', '%CD%', 'c17170262312f3be7027bc2ca825bf0c', wannacry_loaderfileArt33).
loaderFileArtifactMalware(wannacry_loaderfileArt34, wannacry).
loaderFileArtifact('c.wnry', '%CD%', 'ae08f79a0d800b82fcbe1b43cdbdbefc', wannacry_loaderfileArt34).


encryptorFileArtifact('00000000.res', wannacry).
encryptorFileArtifact('00000000.pky', wannacry).
encryptorFileArtifact('00000000.eky', wannacry).
encryptorFileArtifact('00000000.dky', wannacry).

% filename, path, MD5, malware 
decryptorFileArtifactMalware(wannacry_decryptorfileArt0, wannacry).
decryptorFileArtifact('taskhsvc.exe', 'TaskData\Tor\', '-', wannacry_decryptorfileArt0).
decryptorFileArtifactMalware(wannacry_decryptorfileArt1, wannacry).
decryptorFileArtifact('mssecsvc.exe', 'C:\WINDOWS\', 'db349b97c37d22f5ea1d1841e3c89eb4', wannacry_decryptorfileArt1). 

dnsSignature('www.iuqerfsodp9ifjaposdfjhgosurijfaewrwergwea.com', wannacry).
connections(IP, 445, wannacry). %% ip address, port, malware 


%% rules
similarMalware(M1, M2) :- similarLoaderFiles(M1, M2).
similarLoaderFiles(M1, M2) :- loaderFileArtifactMalware(A1, M1), loaderFileArtifactMalware(A2, M2).
similarMalware(M1, M2) :- similarEncryptorFiles(M1, M2).
similarMalware(M1, M2) :- similarDecryptorFiles(M1, M2).
similarMalware(M1, M2) :- similarNetworkSignatures(M1, M2).
similarMalware(M1, M2) :- similarFileChara(M1, M2).

%% setof(X, wannacry^(loaderFileArtifactMalware(X,wannacry)), S).
